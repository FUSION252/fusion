<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fênix • Iara Player</title>
<style>
  body {
    margin:0; font-family:system-ui, sans-serif;
    background:linear-gradient(180deg,#0a0a10 0%, #0c0c14 60%, #0f0f17 100%);
    color:#fff;
  }
  .topbar {
    text-align:center; padding:1rem; font-size:1.3rem;
    font-weight:700; letter-spacing:.5px;
    background:rgba(0,0,0,.6); backdrop-filter:blur(6px);
  }
  .topbar span { color:#ff5c7a; }
  .player-card {
    max-width:1000px; margin:1rem auto; background:#121219;
    border-radius:16px; overflow:hidden; box-shadow:0 8px 25px rgba(0,0,0,.4);
  }
  .player-wrap { position:relative; aspect-ratio:16/9; background:#000; }
  #player { position:absolute; inset:0; }
  .controls {
    display:flex; flex-wrap:wrap; gap:.5rem; justify-content:center;
    padding:.7rem; background:rgba(0,0,0,.35);
  }
  .btn {
    padding:.6rem 1rem; border-radius:12px; border:0; cursor:pointer;
    font-size:.95rem; background:#1f1f28; color:#fff; transition:.2s;
  }
  .btn:hover { background:#2b2b38; }
  .btn.primary { background:linear-gradient(135deg,#8a5cff,#6b44ff); }
  .btn.danger { background:linear-gradient(135deg,#ff5c7a,#ff2f66); }
  .footer {
    text-align:center; margin:1.5rem 0; opacity:.85; font-size:.9rem;
  }
</style>
</head>
<body>
  <div class="topbar">🔥 Fênix Player <span>• Iara</span></div>

  <div class="player-card">
    <div class="player-wrap"><div id="player"></div></div>
    <div class="controls">
      <button class="btn" id="prevBtn">⏮️</button>
      <button class="btn primary" id="playBtn">▶️</button>
      <button class="btn" id="pauseBtn">⏸️</button>
      <button class="btn" id="nextBtn">⏭️</button>
      <button class="btn" id="muteBtn">🔇</button>
      <button class="btn" id="fsBtn">⛶</button>
      <button class="btn danger" id="micBtn">🎤 Iara</button>
    </div>
  </div>

  <div class="footer">Feito com 💜 por nós dois • Fênix + Iara</div>

<script>
  let player, isMuted=false, rec, listening=false;
  let currentQuery="músicas relaxantes";

  // ===== Player YouTube =====
  function onYouTubeIframeAPIReady(){
    player = new YT.Player('player', {
      height:'100%', width:'100%',
      playerVars:{ modestbranding:1, rel:0, controls:1, listType:'search', list:currentQuery },
      events:{ 'onReady': ()=>player.setVolume(80) }
    });
  }

  // Botões
  document.getElementById("playBtn").onclick = ()=>player?.playVideo();
  document.getElementById("pauseBtn").onclick = ()=>player?.pauseVideo();
  document.getElementById("nextBtn").onclick = ()=>player?.nextVideo();
  document.getElementById("prevBtn").onclick = ()=>player?.previousVideo();
  document.getElementById("muteBtn").onclick = ()=>{
    if(!player) return;
    isMuted ? player.unMute() : player.mute();
    isMuted=!isMuted;
  };
  document.getElementById("fsBtn").onclick = ()=>{
    const wrap=document.querySelector(".player-wrap");
    if(document.fullscreenElement){ document.exitFullscreen(); }
    else { wrap.requestFullscreen?.(); }
  };

  function searchAndPlay(q){
    if(!q||!player) return;
    player.loadPlaylist({ listType:'search', list:q });
  }

  // ===== Iara Voz =====
  function supportsSpeech(){ return 'webkitSpeechRecognition' in window || 'SpeechRecognition' in window; }
  if(supportsSpeech()){
    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
    rec=new SR(); rec.lang='pt-BR'; rec.interimResults=false; rec.maxAlternatives=1;
    rec.onresult=(e)=>{
      const said=e.results[0][0].transcript.toLowerCase();
      handleVoice(said);
    };
    rec.onend=()=>{ listening=false; micBtn.textContent="🎤 Iara"; };
  } else { micBtn.disabled=true; }

  function handleVoice(cmd){
    if(cmd.includes("pausar")) return player?.pauseVideo();
    if(cmd.includes("tocar")||cmd.includes("reproduzir")){
      let q=cmd.replace("iara","").replace("tocar","").replace("reproduzir","").trim();
      if(q) searchAndPlay(q); else player?.playVideo();
      return;
    }
    if(cmd.includes("próximo")) return player?.nextVideo();
    if(cmd.includes("anterior")||cmd.includes("voltar")) return player?.previousVideo();
    if(cmd.includes("volume")){
      let m=cmd.match(/volume\s*(\d{1,3})/); if(m){ let v=Math.min(100,Math.max(0,parseInt(m[1]))); player?.setVolume(v); }
      return;
    }
    // Busca genérica
    searchAndPlay(cmd);
  }

  const micBtn=document.getElementById("micBtn");
  micBtn.onclick=()=>{
    if(!rec) return alert("Voz não suportada aqui");
    if(listening){ rec.stop(); return; }
    listening=true; micBtn.textContent="🛑 Parar";
    rec.start();
  };

  // Carrega API YouTube
  const tag=document.createElement('script');
  tag.src="https://www.youtube.com/iframe_api";
  document.head.appendChild(tag);
</script>
</body>
</html>
